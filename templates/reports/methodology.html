{% extends 'base.html' %}
{% load static %}
{% load report_filters %}

{% block title %}Research Methodology - {{ report.title }} - Market Research Platform{% endblock %}

{% block content %}
<style>
    /* Global Background matching detail page */
    html,
    body {
        background: radial-gradient(at 0% 0%, rgba(226, 232, 240, 0.5) 0px, transparent 50%),
            radial-gradient(at 100% 0%, rgba(203, 213, 225, 0.4) 0px, transparent 50%),
            radial-gradient(at 100% 100%, rgba(226, 232, 240, 0.5) 0px, transparent 50%),
            radial-gradient(at 0% 100%, rgba(203, 213, 225, 0.4) 0px, transparent 50%),
            #f8fafc;
        max-width: 100%;
    }

    /* Hero Section - Simplified for Methodology */
    .methodology-hero {
        position: relative;
        background: radial-gradient(circle at 10% 20%, #1e3a8a 0%, #1e40af 90%);
        color: white;
        padding: 3rem 0;
        border-bottom: 5px solid #f97316;
        margin-bottom: 0;
        overflow: hidden;
    }

    .methodology-hero::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -10%;
        width: 60%;
        height: 120%;
        background: radial-gradient(circle, rgba(59, 130, 246, 0.15) 0%, transparent 70%);
        border-radius: 50%;
        filter: blur(80px);
        pointer-events: none;
    }

    .container {
        max-width: 1540px;
        margin: 0 auto;
        padding: 0 2rem;
        position: relative;
        z-index: 2;
    }

    .report-title-link {
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        font-size: 0.9rem;
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        transition: color 0.2s;
    }

    .report-title-link:hover {
        color: white;
        text-decoration: underline;
    }

    .page-title {
        font-size: 2.2rem;
        font-weight: 800;
        margin-bottom: 1rem;
        color: white;
    }

    /* Layout Grid */
    .methodology-grid {
        max-width: 1540px;
        margin: 0 auto;
        padding: 4rem 2rem;
        display: grid;
        grid-template-columns: 1fr 380px;
        gap: 6rem;
        align-items: start;
        width: 100%;
        box-sizing: border-box;
    }

    /* Main Content */
    .methodology-content {
        background: white;
        padding: 3rem;
        border-radius: 20px;
        border: 1px solid rgba(226, 232, 240, 0.8);
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
        color: #334155;
        line-height: 1.8;
        font-size: 1.05rem;
    }

    .methodology-content h2 {
        color: #1e3a8a;
        font-size: 1.75rem;
        margin-top: 2.5rem;
        margin-bottom: 1.25rem;
        font-weight: 800;
        border-bottom: 2px solid #e2e8f0;
        padding-bottom: 0.75rem;
    }

    .methodology-content h2:first-child {
        margin-top: 0;
    }

    .methodology-content h3 {
        color: #0f172a;
        font-size: 1.35rem;
        margin-top: 2rem;
        margin-bottom: 1rem;
        font-weight: 700;
    }

    .methodology-content p {
        margin-bottom: 1.25rem;
        text-align: justify;
    }

    .methodology-content ul {
        margin-bottom: 1.5rem;
        padding-left: 1.5rem;
    }

    .methodology-content li {
        margin-bottom: 0.75rem;
        position: relative;
        list-style: none;
    }

    .methodology-content li::before {
        content: "→";
        color: #3b82f6;
        font-weight: bold;
        display: inline-block;
        width: 1.5em;
        margin-left: -1.5em;
    }

    /* Sidebar - keeping consistent with Report Detail */
    .methodology-sidebar {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        position: sticky;
        top: 2rem;
        align-self: start;
    }

    .sidebar-widget {
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 16px;
        padding: 1.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
    }

    .widget-title {
        color: #1e3a8a;
        font-size: 1.1rem;
        font-weight: 700;
        margin-bottom: 1.25rem;
        padding-bottom: 0.75rem;
        border-bottom: 2px solid #f1f5f9;
    }

    .sidebar-btn {
        display: block;
        width: 100%;
        padding: 1rem;
        border-radius: 12px;
        text-align: center;
        text-decoration: none;
        font-weight: 700;
        font-size: 1.05rem;
        transition: all 0.3s;
        margin-bottom: 1rem;
        color: white;
    }

    .sidebar-btn:hover {
        transform: translateY(-2px);
        filter: brightness(1.1);
    }

    /* Button Colors */
    .btn-red-sample {
        background: linear-gradient(135deg, #ef4444, #dc2626);
    }

    .btn-yellow-discount {
        background: linear-gradient(135deg, #f59e0b, #d97706);
    }

    .btn-blue-analyst {
        background: linear-gradient(135deg, #3b82f6, #2563eb);
    }

    .btn-green-buy {
        background: linear-gradient(135deg, #16a34a, #15803d);
    }

    .back-link {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        color: #64748b;
        text-decoration: none;
        font-weight: 600;
        margin-bottom: 1rem;
        transition: color 0.2s;
    }

    .back-link:hover {
        color: #1e3a8a;
    }

    @media (max-width: 992px) {
        .methodology-grid {
            grid-template-columns: 1fr;
            gap: 3rem;
        }

        .methodology-sidebar {
            order: 2;
            position: static;
        }
    }
</style>

<!-- Hero Section -->
<div class="methodology-hero">
    <div class="container">
        <a href="{% url 'report-detail' report.slug %}" class="report-title-link">
            <i class="fas fa-arrow-left"></i> Back to Report: {{ report.title }}
        </a>
        <h1 class="page-title">Research Methodology</h1>
    </div>
</div>

<div class="methodology-grid">
    <!-- Main Content with Provided Methodology Text -->
    <div class="methodology-content">
        <h2>Research Framework and Methodological Approach — MarketsNXT</h2>

        <!-- Main Process Flow -->
        <div class="process-flow-container">
            <div class="process-step">
                <div class="step-circle">
                    <i class="fas fa-database"></i>
                </div>
                <h4>Information<br>Procurement</h4>
            </div>
            <div class="step-arrow"><i class="fas fa-chevron-right"></i></div>
            <div class="process-step">
                <div class="step-circle">
                    <i class="fas fa-chart-pie"></i>
                </div>
                <h4>Information<br>Analysis</h4>
            </div>
            <div class="step-arrow"><i class="fas fa-chevron-right"></i></div>
            <div class="process-step">
                <div class="step-circle">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h4>Market Formulation<br>& Validation</h4>
            </div>
        </div>

        <style>
            .process-flow-container {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 1rem;
                margin: 3rem 0;
                padding: 2rem;
                background: #f8fafc;
                border-radius: 16px;
                border: 1px dashed #cbd5e1;
            }

            .process-step {
                text-align: center;
                position: relative;
                width: 160px;
            }

            .step-circle {
                width: 80px;
                height: 80px;
                background: linear-gradient(135deg, #4B2D6D 0%, #3a1f58 100%);
                /* Deep Purple */
                color: white;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 2rem;
                margin: 0 auto 1rem;
                box-shadow: 0 8px 15px rgba(75, 45, 109, 0.2);
                border: 4px solid #fff;
                outline: 2px solid #00C1D4;
                /* Teal Accent */
            }

            .process-step h4 {
                color: #1e293b;
                font-weight: 700;
                line-height: 1.3;
                font-size: 1rem;
            }

            .step-arrow {
                color: #00C1D4;
                font-size: 2rem;
                opacity: 0.5;
            }

            @media (max-width: 640px) {
                .process-flow-container {
                    flex-direction: column;
                    gap: 2rem;
                }

                .step-arrow {
                    transform: rotate(90deg);
                }

                .step-circle {
                    width: 60px;
                    height: 60px;
                    font-size: 1.5rem;
                }
            }
        </style>

        <h3>Overview of Our Research Process</h3>
        <p>MarketsNXT follows a structured, multi-stage research framework designed to ensure accuracy, reliability, and
            strategic relevance of every published study. Our methodology integrates globally accepted research
            standards with industry best practices in data collection, modeling, verification, and insight generation.
        </p>

        <!-- Data Acquisition Grid -->
        <h3 style="margin-top: 3rem;">1. Data Acquisition Strategy</h3>
        <p>Robust data collection is the foundation of our analytical process. MarketsNXT employs a layered sourcing
            model.</p>

        <div class="procurement-grid">
            <div class="proc-card secondary">
                <div class="proc-header">
                    <i class="fas fa-book-open"></i> Secondary Research
                </div>
                <ul class="proc-list">
                    <li>Company annual reports & SEC filings</li>
                    <li>Industry association publications</li>
                    <li>Technical journals & white papers</li>
                    <li>Government databases (World Bank, OECD)</li>
                    <li>Paid commercial databases</li>
                </ul>
            </div>
            <div class="proc-card primary">
                <div class="proc-header">
                    <i class="fas fa-comments"></i> Primary Research
                </div>
                <ul class="proc-list">
                    <li>KOL Interviews (CEOs, Marketing Heads)</li>
                    <li>Surveys with industry participants</li>
                    <li>Distributor & supplier discussions</li>
                    <li>End-user feedback loops</li>
                    <li>Questionnaires for gap analysis</li>
                </ul>
            </div>
        </div>

        <style>
            .procurement-grid {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 2rem;
                margin: 2rem 0;
            }

            .proc-card {
                border-radius: 12px;
                overflow: hidden;
                border: 1px solid #e2e8f0;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.02);
            }

            .proc-header {
                padding: 1rem 1.5rem;
                font-weight: 700;
                font-size: 1.1rem;
                display: flex;
                align-items: center;
                gap: 0.75rem;
            }

            .proc-card.secondary .proc-header {
                background: #E8F8FA;
                /* Light Teal */
                color: #0e7490;
            }

            .proc-card.primary .proc-header {
                background: #F3E8FF;
                /* Light Purple */
                color: #6b21a8;
            }

            .proc-list {
                padding: 1.5rem;
                margin: 0;
            }

            .proc-list li {
                list-style: none;
                margin-bottom: 0.75rem;
                position: relative;
                padding-left: 1.5rem;
                font-size: 0.95rem;
            }

            .proc-list li::before {
                color: #00C1D4;
                /* Teal arrow */
                font-weight: bold;
                content: "➤";
                position: absolute;
                left: 0;
                font-size: 0.8rem;
                top: 2px;
            }

            @media (max-width: 768px) {
                .procurement-grid {
                    grid-template-columns: 1fr;
                }
            }
        </style>


        <h3>Analytical Modeling and Insight Development</h3>
        <p>After collection, datasets are processed and interpreted using multiple analytical techniques to identify
            baseline market values, demand patterns, growth drivers, constraints, and opportunity clusters. MarketsNXT
            selects analytical models based on the nature of the market and the forecasting objective.</p>
        <p>Our analytical toolkit includes demand modeling, trend mapping, penetration analysis, and scenario
            forecasting supported by statistical and heuristic techniques.</p>

        <!-- Pyramids Section -->
        <h3 style="margin-top: 3rem;">2. Market Estimation Techniques</h3>
        <p>MarketsNXT applies multiple estimation pathways to strengthen forecast accuracy.</p>

        <div class="approaches-container">
            <!-- Bottom Up Approach -->
            <div class="approach-box">
                <h4>Bottom-up Approach</h4>
                <div class="pyramid-container bottom-up">
                    <div class="pyramid-level l1"><span>Country Level Market Size</span></div>
                    <div class="pyramid-level l2"><span>Regional Market Size</span></div>
                    <div class="pyramid-level l3"><span>Global Market Size</span></div>
                </div>
                <p class="approach-desc">Aggregating granular demand data from country level to derive global figures.
                </p>
            </div>

            <!-- Top Down Approach -->
            <div class="approach-box">
                <h4>Top-down Approach</h4>
                <div class="pyramid-container top-down">
                    <div class="pyramid-level l1"><span>Parent Market Size</span></div>
                    <div class="pyramid-level l2"><span>Target Market Share</span></div>
                    <div class="pyramid-level l3"><span>Segmented Market Size</span></div>
                </div>
                <p class="approach-desc">Breaking down the parent industry market to identify the target serviceable
                    market.</p>
            </div>
        </div>

        <style>
            .approaches-container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 4rem;
                /* Increased gap */
                margin: 2rem 0;
            }

            .approach-box {
                text-align: center;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .approach-box h4 {
                color: #4B2D6D;
                margin-bottom: 2rem;
                font-size: 1.25rem;
                font-weight: 800;
            }

            .pyramid-container {
                display: flex;
                flex-direction: column;
                align-items: center;
                width: 100%;
                max-width: 350px;
                /* Constrain max width */
                margin-bottom: 2rem;
                filter: drop-shadow(0 10px 15px rgba(0, 0, 0, 0.1));
                /* Moving shadow to container to respect clip-path */
            }

            .pyramid-level {
                width: 100%;
                background: #00C1D4;
                color: white;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: 700;
                font-size: 0.9rem;
                padding: 1rem 0.5rem;
                /* Increased padding */
                text-align: center;
                line-height: 1.2;
                position: relative;
                z-index: 1;
            }

            /* Bottom Up Styling (Standard Pyramid) */
            /* l1 = Base (Bottom), l2 = Middle, l3 = Tip (Top) */
            .bottom-up {
                flex-direction: column-reverse;
            }

            .bottom-up .l1 {
                width: 100%;
                background: #4B2D6D;
                padding-bottom: 0.5rem;
                /* Almost rectangular base */
                clip-path: polygon(0 0, 100% 0, 95% 100%, 5% 100%);
            }

            .bottom-up .l2 {
                width: 90%;
                /* Wider middle */
                background: #00C1D4;
                clip-path: polygon(5% 0, 95% 0, 90% 100%, 10% 100%);
            }

            .bottom-up .l3 {
                width: 80%;
                /* Much wider top */
                background: #60a5fa;
                /* Very blunt tip */
                clip-path: polygon(10% 0, 90% 0, 85% 100%, 15% 100%);
                padding-top: 1.2rem;
                margin-bottom: -1px;
                font-size: 0.85rem;
                /* Smaller font for tip */
            }

            /* Top Down Styling (Inverted Pyramid) */
            /* l1 = Base (Top), l2 = Middle, l3 = Tip (Bottom) */
            .top-down .l1 {
                width: 100%;
                background: #4B2D6D;
                padding-top: 1.2rem;
                clip-path: polygon(0 0, 100% 0, 95% 100%, 5% 100%);
            }

            .top-down .l2 {
                width: 90%;
                background: #00C1D4;
                clip-path: polygon(5% 0, 95% 0, 90% 100%, 10% 100%);
            }

            .top-down .l3 {
                width: 80%;
                /* Much wider bottom tip */
                background: #60a5fa;
                clip-path: polygon(10% 0, 90% 0, 85% 100%, 15% 100%);
                padding-bottom: 1.2rem;
                font-size: 0.85rem;
            }

            .approach-desc {
                font-size: 0.95rem;
                color: #64748b;
                line-height: 1.6;
                max-width: 90%;
            }

            /* Text tweaks for small shapes */
            .pyramid-level span {
                display: block;
                max-width: 95%;
                /* Allow text to use almost full width */
            }

            @media (max-width: 768px) {
                .approaches-container {
                    grid-template-columns: 1fr;
                    gap: 3rem;
                }
            }
        </style>

        <h3>Supply Chain Anchored Forecasting</h3>
        <p>MarketsNXT integrates value chain intelligence into its forecasting structure to ensure commercial realism
            and operational alignment.</p>
        <h4>Supply-Side Evaluation</h4>
        <p>Revenue and capacity estimates are developed through company financial reviews, product portfolio mapping,
            benchmarking of competitive positioning, and commercialization tracking. We also evaluate pipeline
            developments, distribution reach, and strategic initiatives.</p>
        <h4>Demand-Side Evaluation</h4>
        <p>Demand projections are developed by mapping end-use industries, adjacent markets, adoption rates, and segment
            penetration levels. Subject matter expert inputs are incorporated to refine demand trajectories and usage
            assumptions.</p>
        <h4>Market Share Allocation Models</h4>
        <p>Structured scoring and weighted factor models are used to estimate participant shares and segment
            distribution patterns.</p>

        <h3>Forecast Construction Approaches</h3>
        <ul>
            <li><strong>Segment Demand Aggregation:</strong> Individual product and application demand across
                geographies is modeled and consolidated to derive total opportunity size.</li>
            <li><strong>Penetration and Adoption Modeling:</strong> Used particularly for emerging products and
                technologies where adoption curves and substitution patterns influence growth.</li>
            <li><strong>Statistical and Multivariable Forecasting:</strong> Regression and variable-sensitivity models
                are used where sufficient historical and cross-factor data is available.</li>
            <li><strong>Consumption Flow Modeling:</strong> Commodity flow and utilization mapping are applied to
                validate volume movements across the ecosystem.</li>
        </ul>

        <h3>Market Sizing Finalization and Quality Control</h3>
        <p>Before publication, MarketsNXT subjects all estimates and forecasts to a structured internal review and
            expert validation workflow.</p>
        <ul>
            <li><strong>Estimate Consolidation:</strong> All modeled outputs are reconciled and aligned across segments
                and regions.</li>
            <li><strong>Data Harmonization:</strong> Figures are normalized to ensure consistency across sources,
                timeframes, and currency references.</li>
            <li><strong>Expert Verification:</strong> Independent industry specialists and senior analysts review
                assumptions, outputs, and interpretations.</li>
            <li><strong>Multi-Level Validation:</strong> Reports proceed to release only after passing layered quality
                and accuracy checks.</li>
        </ul>

        <h3>3. Market Engineering & Validation</h3>
        <p>Market engineering involves the triangulation of data from multiple sources to minimize errors.</p>

        <div class="validation-box">
            <div class="v-step">
                <span class="v-num">01</span>
                <strong>Data Mining</strong>
                <p>Extensive gathering of raw data.</p>
            </div>
            <div class="v-line"></div>
            <div class="v-step">
                <span class="v-num">02</span>
                <strong>Analysis</strong>
                <p>Statistical regression & trend analysis.</p>
            </div>
            <div class="v-line"></div>
            <div class="v-step">
                <span class="v-num">03</span>
                <strong>Validation</strong>
                <p>Cross-verification with experts.</p>
            </div>
            <div class="v-line"></div>
            <div class="v-step">
                <span class="v-num">04</span>
                <strong>Final Output</strong>
                <p>Publication of market study.</p>
            </div>
        </div>

        <style>
            .validation-box {
                display: flex;
                align-items: flex-start;
                justify-content: space-between;
                background: #f1f5f9;
                padding: 2rem;
                border-radius: 16px;
                margin: 2rem 0;
            }

            .v-step {
                flex: 1;
                text-align: center;
                padding: 0 0.5rem;
            }

            .v-num {
                display: inline-block;
                background: #4B2D6D;
                color: white;
                font-weight: 700;
                padding: 0.25rem 0.75rem;
                border-radius: 8px;
                margin-bottom: 0.75rem;
                font-size: 0.9rem;
            }

            .v-step strong {
                display: block;
                color: #1e293b;
                margin-bottom: 0.5rem;
            }

            .v-step p {
                font-size: 0.85rem;
                color: #64748b;
                margin: 0;
            }

            .v-line {
                width: 1px;
                height: 80px;
                background: #cbd5e1;
                margin-top: 1rem;
            }

            @media (max-width: 640px) {
                .validation-box {
                    flex-direction: column;
                    gap: 1.5rem;
                }

                .v-line {
                    width: 100%;
                    height: 1px;
                    margin: 0;
                }
            }
        </style>

        <h3>Client-Centric Research Delivery</h3>
        <p>MarketsNXT positions research delivery as a collaborative engagement rather than a static information
            transfer. Analysts work with clients to clarify objectives, interpret findings, and connect insights to
            strategic decisions. Each engagement includes a designated contact lead to support communication and
            continuity throughout the project lifecycle.</p>

        <h3>Market Environment Inputs Considered</h3>
        <p>Our market models incorporate a broad set of contextual variables to ensure realistic projections, including:
        </p>
        <ul>
            <li>Macro and microeconomic indicators</li>
            <li>Regulatory and policy landscape</li>
            <li>Industry-specific compliance structures</li>
            <li>Technology evolution factors</li>
            <li>Capital investment activity</li>
            <li>Infrastructure and capacity expansion trends</li>
            <li>Channel economics and margin structures</li>
        </ul>

        <h3>Custom Requirement Integration</h3>
        <p>MarketsNXT adapts research frameworks to address specific client priorities. Studies can be tailored to
            support initiatives such as market entry planning, product launch evaluation, partnership screening,
            investment feasibility assessment, geographic expansion, technology benchmarking, and customer intelligence
            programs.</p>

        <h3>Strategy and Insight Translation</h3>
        <p>The final stage converts validated findings into decision-ready intelligence. MarketsNXT develops actionable
            roadmaps, opportunity matrices, and strategic recommendations aligned with client goals and market
            realities.</p>
    </div>

    <!-- Sidebar (Simplified from Detail Page) -->
    <div class="methodology-sidebar">
        <!-- Report Info Widget -->
        <div class="sidebar-widget">
            <h3 class="widget-title">About This Report</h3>
            <p style="font-size: 0.9rem; color: #475569; margin-bottom: 1rem;">
                This methodology applies to the report: <strong>{{ report.title }}</strong>
            </p>
            <div style="font-size: 0.85rem; color: #64748b; margin-bottom: 1rem;">
                <i class="far fa-calendar-alt"></i> {{ report.publish_date|date:"F Y" }} |
                <i class="far fa-file-alt"></i> {{ report.pages_count }} Pages
            </div>
            <a href="{% url 'report-detail' report.slug %}" class="sidebar-btn btn-green-buy">
                View Report Details
            </a>
        </div>

        <!-- Action Buttons -->
        <div class="sidebar-widget">
            <h3 class="widget-title">Interested?</h3>
            <a href="{% url 'request-sample' report.slug %}" class="sidebar-btn btn-red-sample">
                Download PDF Sample
            </a>
            <a href="{% url 'ask-for-discount' report.slug %}" class="sidebar-btn btn-yellow-discount">
                Ask For Discount
            </a>
            <a href="{% url 'speak-to-analyst' report.slug %}" class="sidebar-btn btn-blue-analyst">
                Speak to Analyst
            </a>
        </div>

        <!-- Need Specific Data Widget -->
        <div class="sidebar-widget" style="background: linear-gradient(135deg, #fff 0%, #f0f9ff 100%);">
            <h3 class="widget-title">Need Specific Data?</h3>
            <p style="font-size: 0.95rem; color: #475569; margin-bottom: 1rem; line-height: 1.5;">
                We offer <strong>10% free customization</strong> with every report.
            </p>
            <a href="{% url 'speak-to-analyst' report.slug %}" class="sidebar-btn btn-blue-analyst"
                style="margin-bottom: 0;">
                Request Customization
            </a>
        </div>
    </div>
</div>
{% endblock %}